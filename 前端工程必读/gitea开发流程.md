\### 分支的分类

首先我们将分支分为**固定的3个分支**：

\- master：主分支，随时都可以发布，不允许直接合并。

\- staging：测试分支，刚刚开发完的功能或者修复的bug，由开发者随时合并，之后可以走ci自动发布到测试环境进行测试。

\- DEV-n*userName*devIntroText：开发分支已大写“DEV-”开头，n与issuse号相同，userName是开发者姓名，devIntroText描述此开发分支的功能，分支由开发人员自行创建和提交。

\### 建立（tag）标签

对于issue和pr来说，我们都需要贴对应的tag（标签），来标识对应的状态。一般来说我们会建立如下标签:

\- 空 //新需求

\- dev //开发

\- fixbug //修复bug

\- doc //文档编写

\- review //代码审查

\- test //测试

\- testfinish //测试完成

\- closed //关闭

\- PR //master代码合并提交

\### 人员的划分

在我们的整个git分支管理方法中分为4个角色

\- 测试人员：测试开发人员写的代码

\- 开发人员：写代码，实现新功能或者修复bug

\- 产品经理：提需求

\- 研发组长：代码审查，合并代码

\### 具体的流程与对应角色

因为每个角色做的事情都不一样，所以我按照角色和动作划分了一下。

\#### 动作：新需求/BUG/DOC

\##### 角色：产品经理

1\. 创建issue，指派给研发组长；

2\. 研发组长，指派给相应的开发人员，标记里程碑。

\##### 角色：开发人员

1\. 通过被指派人，和“dev”标签来搜索新工单；

2\. 基于master新建新的开发分支，提交开发分支；

3\. 到gitea上找到相应的工单，然后将工单和提交的分支关联起来；

4\. 开发开始时，将工单拖入开发看板；

5\. 编写代码实现新需求，每日多次提交开发分支；

6\. 代码编写完成并且本地测试完成之后，可将代码合并到staging分支并提交，提交后会自动化部署到测试环境，自行测试。

7\. 自行测试没有问题，提PR，提PR的时候需要设置依赖工单。

8\. 将工单tag的“dev”修改为“review“和”PR”。

\#####  角色：code review成员

1\. 检查代码是否符合规范。（code review）；

2\. review有问题在PR中留言，并在工单中@开发者；

3\. review没有问题 修改工单标签“review”改为 “test”。

\##### 角色：测试人员

1\. 通过指派人，和“test”标签来搜索测试单子，在测试服务器上测试新的需求是否如期实现；

2\. 如果有bug，在关联的工单来记录这个bug；

3\. 如果新需求没有bug或者所有关联的bug都修复完毕，将工单标记“test”改为“testfinish”。

\##### 角色：研发组长

1\. 查看工单状态包含“testfinish”，“PR”的标签；

2\. 查看PR是否关联了工单，没关联工单的不可合并。（因为你不知道有没有bug）；

3\. 检查代码是否符合规范。（code review）；

4\. 先关闭关联的工单之后，在合并PR，合并有冲突需要@开发人员先解决冲突。

PR冲突解决办法：

1\. 开发分支合并master后再提交。